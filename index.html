<!DOCTYPE html>
<html>
<head>
	<title>d3 fun</title>
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:300,400,700" type="text/css">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.14.3/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.14.3/mapbox-gl.css' rel='stylesheet' />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script src="newscript.js"></script>
	<script src="comhealth.js"></script>
	<script src="gardens.js"></script>
</head>
<body>
	<div id="header">
		<p></p>
		<nav>
		</nav>
	</div>
	<div id="map_container">
		<div class="filter_button" id="garden">
			<i class="fa fa-leaf"></i>
		</div>
		<div class="filter_button" id="health">
			<i class="fa fa-medkit"></i>
		</div>
		<div id="map">
		</div>
	</div>
	<script type="text/javascript">
		mapboxgl.accessToken = 'pk.eyJ1IjoiYXMxNzMxNzEiLCJhIjoiY2lsNDR6bWdwM3cxb3Z5bTNvbmtmeTJsbiJ9.16HxpvRVaoKgLOBG9L-Quw';

		var map = new mapboxgl.Map({
	    	container: 'map', // container id
	    	style: 'mapbox://styles/as173171/ciku69e5q009998kmnudm6j2e', //hosted style id
	   		center: [-73.977800, 40.715824], // starting position
	   		zoom: 10, // starting zoom
		});


		map.on('style.load', function(){
			map.addSource('boroughs', {
				'type': 'vector',
				'url': 'mapbox://as173171.3dk6khr6'
			});

			map.addLayer({
				"id": "boroughs",
				"type": "fill",
				"source-layer": "boroughs",
				"source": "boroughs",
				"interactive": true,
				"layout": {},
				"paint": {
					"fill-color": "#2B3E42",
					"fill-opacity": 0.5,
					"fill-outline-color": "#26244d"
				}
			});

			map.addLayer({
				"id": "route-hover",
				"type": "fill",
				"source": "boroughs",
				"source-layer":"boroughs",
				"layout": {},
				"paint": {
					"fill-color": "#2B3E42",
					"fill-opacity": 0.8,
					"fill-outline-color": "#26244d"
				},
				"filter": ["==", "BoroCode", ""]
			});

			map.on("mousemove", function(e) {
				map.featuresAt(e.point, {
					radius: 5,
					layers: ["boroughs-fill"]
				}, function (err, features){
					if (!err && features.length) {
						map.setFilter("route-hover", ["==", "BoroCode", features[0].properties.BoroCode]);
					}
					// } else {
					// 	map.setFilter("route-hover", ["==", "BoroName", features[0].properties.BoroName]);
					// }
				});
			});

			// on hover
			// check to see what the filter / borocode is (features[0])
			// pan to 

			// map.on("click", function(e){
			// 	map.featuresAt(e.point, {
			// 		radius: 5, 
			// 		layers: ["boroughs-fill"]
			// 	}, 


			// });

		

			// disable zooming on scroll, makes it easier to navigate around the page without accidentally zooming way out or way in
			map.scrollZoom.disable();
			map.doubleClickZoom.disable();
			map.on('click', function(data) {
			  var e = data && data.originalEvent;
			  console.log('got click ' + (e ? 'button = ' + e.button : ''));
			});

			var popup = new mapboxgl.Popup();

			map.on('mousemove', function (e) {
				map.featuresAt(e.point, {
					radius: 1, 
					includeGeometry: true,
					layer: 'boroughs',
				}, function (err, features) {
					if (err || !features.length) {
						popup.remove();
						return;
					}

					var feature = features[0];

					popup.setLngLat(map.unproject(e.point))
						.setHTML(feature.properties.BoroName)
						.addTo(map);
				});
			});
		});
	</script>
	<div id="locationName">
		<h2>Select a Burough</h2>
	</div>
	<div id="selector">
		<p>Select a Borough   </p><select id="locSelect">
			<option value="06000US3604710022">Brooklyn</option>
			<option value="06000US3608160323">Queens</option>
			<option value="06000US3600508510">Bronx</options>
			<option value="06000US3606144919">Manhattan</options>
			<option value="06000US3608570915">Staten Island</options>
		</select>
		<button id="select">Select</button>
	</div>
	<div id="healthCenters">
		<div id="pie1"></div>
		<div id="hchart"></div>
	</div>
	<div id="communityGardens">
		<div id="gchart"></div>
		<div id="pie2"></div>
	</div>
	<div selectedBoroughs>
		<div id="graph"></div>
		<div id="tables"></div>
	</div>
</body>
</html>


